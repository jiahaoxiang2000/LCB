Alexandre Adomnicai (original AVR implementation)
Adapted to ARMv7-M assembly